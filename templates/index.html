<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Expense Tracker</title>

  <style>
    body { margin:0; padding:0; font-family:Arial,sans-serif; background:#f5f5f5; }
    .container { max-width:1000px; margin:30px auto; padding:20px; background:#fff; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1);}
    h1 { text-align:center; margin-top:0; }
    .total { text-align:center; font-size:18px; margin-bottom:20px; padding:10px; background:#eee; border-radius:6px; }

    form.add-form { display:grid; grid-template-columns:1fr 1fr 1fr auto; gap:10px; margin-bottom:20px; }
    input, select { padding:10px; border:1px solid #ccc; border-radius:6px; width:100%; box-sizing:border-box; }
    button { padding:10px 14px; border:none; border-radius:6px; cursor:pointer; font-weight:bold; }
    button.add { background:#28a745; color:white; }
    button.update { background:#007bff; color:white; width:100%; }
    button.delete { background:#dc3545; color:white; width:100%; }

    .table-wrap { overflow-x:auto; }
    table { width:100%; border-collapse:collapse; min-width:700px; }
    th, td { border:1px solid #ddd; padding:10px; text-align:center; vertical-align:middle; }
    th { background:#222; color:#fff; position:sticky; top:0; }

    .action-box { display:flex; flex-direction:column; gap:6px; }
    .edit-form { display:grid; grid-template-columns:1fr 1fr 1fr; gap:6px; }

    /* Mobile Friendly */
    @media (max-width: 768px) {
      form.add-form { grid-template-columns:1fr; }
      table { min-width:600px; }
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Expense Tracker</h1>
    <div class="total"><b>Total Spent:</b> ₹ {{ total }}</div>

    <!-- ADD NEW EXPENSE -->
    <form class="add-form" method="POST" action="/">
      <input type="text" name="title" placeholder="Expense title" required />
      <input type="number" step="0.01" name="amount" placeholder="Amount" required />
      <select name="category" required>
        <option value="" disabled selected>Select category</option>
        <option value="Food">Food</option>
        <option value="Travel">Travel</option>
        <option value="Shopping">Shopping</option>
        <option value="Bills">Bills</option>
        <option value="Other">Other</option>
      </select>
      <button type="submit" class="add">Add</button>
    </form>

    <!-- EXPENSE TABLE -->
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Created At</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for e in expenses %}
          <tr>
            <td>{{ e.id }}</td>
            <td>{{ e.title }}</td>
            <td>₹ {{ "%.2f"|format(e.amount) }}</td>
            <td>{{ e.category }}</td>
            <td>{{ e.created_at }}</td>
            <td>
              <div class="action-box">
                <!-- EDIT FORM -->
                <form method="POST" action="/edit/{{ e.id }}">
                  <div class="edit-form">
                    <input type="text" name="title" value="{{ e.title }}" required />
                    <input type="number" step="0.01" name="amount" value="{{ e.amount }}" required />
                    <input type="text" name="category" value="{{ e.category }}" required />
                  </div>
                  <button type="submit" class="update">Edit</button>
                </form>

                <!-- DELETE FORM -->
                <form method="POST" action="/delete/{{ e.id }}">
                  <button type="submit" class="delete">Delete</button>
                </form>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</body>
</html>
